2022-06-02 00:13:54.287808: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found
2022-06-02 00:13:54.287936: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
[*********************100%***********************]  1 of 1 completed
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 7, 'KEEP_HOLDING_RATE': 0, 'TAKE_PROFIT_ACTIVE_ACTION': (2, 1.5), 'USE_ATR': True}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
2022-06-02 00:14:15.390743: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found
2022-06-02 00:14:15.391031: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cublas64_11.dll'; dlerror: cublas64_11.dll not found
2022-06-02 00:14:15.391315: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cublasLt64_11.dll'; dlerror: cublasLt64_11.dll not found
2022-06-02 00:14:15.392018: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cufft64_10.dll'; dlerror: cufft64_10.dll not found
2022-06-02 00:14:15.392418: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'curand64_10.dll'; dlerror: curand64_10.dll not found
2022-06-02 00:14:15.392674: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cusolver64_11.dll'; dlerror: cusolver64_11.dll not found
2022-06-02 00:14:15.392934: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cusparse64_11.dll'; dlerror: cusparse64_11.dll not found
2022-06-02 00:14:15.393187: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudnn64_8.dll'; dlerror: cudnn64_8.dll not found
2022-06-02 00:14:15.393317: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1850] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2022-06-02 00:14:15.393902: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 43/149 [=======>......................] - ETA: 0s 88/149 [================>.............] - ETA: 0s138/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 1s 31/149 [=====>........................] - ETA: 0s 69/149 [============>.................] - ETA: 0s107/149 [====================>.........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 4s 32/157 [=====>........................] - ETA: 0s 66/157 [===========>..................] - ETA: 0s 99/157 [=================>............] - ETA: 0s134/157 [========================>.....] - ETA: 0s157/157 [==============================] - 0s 2ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.032896286344684965
Best model MSE = 0.1751997023820877, Val MSE = 2.2821528911590576
  1/149 [..............................] - ETA: 2s 30/149 [=====>........................] - ETA: 0s 68/149 [============>.................] - ETA: 0s 93/149 [=================>............] - ETA: 0s103/149 [===================>..........] - ETA: 0s123/149 [=======================>......] - ETA: 0s142/149 [===========================>..] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 7ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.2884371280670166, Val MSE = 3.6714489459991455
  1/148 [..............................] - ETA: 2s 15/148 [==>...........................] - ETA: 0s 38/148 [======>.......................] - ETA: 0s 55/148 [==========>...................] - ETA: 0s 78/148 [==============>...............] - ETA: 0s101/148 [===================>..........] - ETA: 0s123/148 [=======================>......] - ETA: 0s147/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.017636698452663354
Best model MSE = 0.28036871552467346, Val MSE = 1.7710496187210083
  1/157 [..............................] - ETA: 3s 41/157 [======>.......................] - ETA: 0s 79/157 [==============>...............] - ETA: 0s114/157 [====================>.........] - ETA: 0s148/157 [===========================>..] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 10ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.1119682788848877, Val MSE = 6.9691033363342285
  1/149 [..............................] - ETA: 3s 20/149 [===>..........................] - ETA: 0s 44/149 [=======>......................] - ETA: 0s 66/149 [============>.................] - ETA: 0s 89/149 [================>.............] - ETA: 0s112/149 [=====================>........] - ETA: 0s134/149 [=========================>....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865291833877563, Val MSE = 10.520750045776367
  1/149 [..............................] - ETA: 2s 43/149 [=======>......................] - ETA: 0s 83/149 [===============>..............] - ETA: 0s123/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 10ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.4071435928344727, Val MSE = 5.935237407684326
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 48/156 [========>.....................] - ETA: 0s 77/156 [=============>................] - ETA: 0s101/156 [==================>...........] - ETA: 0s123/156 [======================>.......] - ETA: 0s150/156 [===========================>..] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 20/149 [===>..........................] - ETA: 0s 43/149 [=======>......................] - ETA: 0s 61/149 [===========>..................] - ETA: 0s 83/149 [===============>..............] - ETA: 0s 93/149 [=================>............] - ETA: 0s104/149 [===================>..........] - ETA: 0s120/149 [=======================>......] - ETA: 0s139/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.03150412023473918
Best model MSE = 3.926288366317749, Val MSE = 11.163383483886719
  1/149 [..............................] - ETA: 2s 33/149 [=====>........................] - ETA: 0s 76/149 [==============>...............] - ETA: 0s109/149 [====================>.........] - ETA: 0s147/149 [============================>.] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 9ms/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 1s 24/156 [===>..........................] - ETA: 0s 53/156 [=========>....................] - ETA: 0s 79/156 [==============>...............] - ETA: 0s106/156 [===================>..........] - ETA: 0s131/156 [========================>.....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.015115259467555606
Best model MSE = 0.3673790693283081, Val MSE = 0.5763313174247742
  1/148 [..............................] - ETA: 2s 24/148 [===>..........................] - ETA: 0s 45/148 [========>.....................] - ETA: 0s 70/148 [=============>................] - ETA: 0s 92/148 [=================>............] - ETA: 0s118/148 [======================>.......] - ETA: 0s140/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 23/148 [===>..........................] - ETA: 0s 45/148 [========>.....................] - ETA: 0s 67/148 [============>.................] - ETA: 0s 92/148 [=================>............] - ETA: 0s114/148 [======================>.......] - ETA: 0s137/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.3781079351902008, Val MSE = 0.7554776668548584
  1/156 [..............................] - ETA: 2s 15/156 [=>............................] - ETA: 0s 34/156 [=====>........................] - ETA: 0s 57/156 [=========>....................] - ETA: 0s 82/156 [==============>...............] - ETA: 0s104/156 [===================>..........] - ETA: 0s122/156 [======================>.......] - ETA: 0s139/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 11ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.19651460647583, Val MSE = 2.94038724899292
  1/148 [..............................] - ETA: 2s 23/148 [===>..........................] - ETA: 0s 40/148 [=======>......................] - ETA: 0s 62/148 [===========>..................] - ETA: 0s 83/148 [===============>..............] - ETA: 0s107/148 [====================>.........] - ETA: 0s130/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.1521594524383545, Val MSE = 4.952139854431152
  1/148 [..............................] - ETA: 3s 22/148 [===>..........................] - ETA: 0s 44/148 [=======>......................] - ETA: 0s 67/148 [============>.................] - ETA: 0s 89/148 [=================>............] - ETA: 0s111/148 [=====================>........] - ETA: 0s133/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.2837193012237549, Val MSE = 3.69866681098938
  1/156 [..............................] - ETA: 2s 21/156 [===>..........................] - ETA: 0s 42/156 [=======>......................] - ETA: 0s 60/156 [==========>...................] - ETA: 0s 73/156 [=============>................] - ETA: 0s 91/156 [================>.............] - ETA: 0s109/156 [===================>..........] - ETA: 0s135/156 [========================>.....] - ETA: 0s156/156 [==============================] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 5ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.5044217109680176, Val MSE = 4.264066696166992
  1/148 [..............................] - ETA: 2s 19/148 [==>...........................] - ETA: 0s 38/148 [======>.......................] - ETA: 0s 59/148 [==========>...................] - ETA: 0s 76/148 [==============>...............] - ETA: 0s 93/148 [=================>............] - ETA: 0s114/148 [======================>.......] - ETA: 0s132/148 [=========================>....] - ETA: 0s148/148 [==============================] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 25/148 [====>.........................] - ETA: 0s 55/148 [==========>...................] - ETA: 0s 86/148 [================>.............] - ETA: 0s111/148 [=====================>........] - ETA: 0s136/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.5889720916748047, Val MSE = 2.1350257396698
  1/156 [..............................] - ETA: 2s 19/156 [==>...........................] - ETA: 0s 38/156 [======>.......................] - ETA: 0s 59/156 [==========>...................] - ETA: 0s 77/156 [=============>................] - ETA: 0s 98/156 [=================>............] - ETA: 0s116/156 [=====================>........] - ETA: 0s135/156 [========================>.....] - ETA: 0s156/156 [==============================] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 14, 'KEEP_HOLDING_RATE': 0, 'TAKE_PROFIT_ACTIVE_ACTION': (2, 1), 'USE_ATR': True}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 1s 42/149 [=======>......................] - ETA: 0s 92/149 [=================>............] - ETA: 0s138/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 3s 44/149 [=======>......................] - ETA: 0s 84/149 [===============>..............] - ETA: 0s122/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 3s 41/157 [======>.......................] - ETA: 0s 84/157 [===============>..............] - ETA: 0s127/157 [=======================>......] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 5ms/step
MADRC = 0.032896286344684965
Best model MSE = 0.17524230480194092, Val MSE = 2.2823314666748047
  1/149 [..............................] - ETA: 2s 41/149 [=======>......................] - ETA: 0s 81/149 [===============>..............] - ETA: 0s125/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.28844210505485535, Val MSE = 3.6714892387390137
  1/148 [..............................] - ETA: 2s 18/148 [==>...........................] - ETA: 0s 35/148 [======>.......................] - ETA: 0s 51/148 [=========>....................] - ETA: 0s 70/148 [=============>................] - ETA: 0s 87/148 [================>.............] - ETA: 0s107/148 [====================>.........] - ETA: 0s126/148 [========================>.....] - ETA: 0s143/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.017636698452663354
Best model MSE = 0.28026583790779114, Val MSE = 1.7711477279663086
  1/157 [..............................] - ETA: 2s 41/157 [======>.......................] - ETA: 0s 81/157 [==============>...............] - ETA: 0s121/157 [======================>.......] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.029259256099936348
Best model MSE = 1.111831545829773, Val MSE = 6.969064235687256
  1/149 [..............................] - ETA: 3s 32/149 [=====>........................] - ETA: 0s 60/149 [===========>..................] - ETA: 0s 90/149 [=================>............] - ETA: 0s119/149 [======================>.......] - ETA: 0s149/149 [==============================] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 8ms/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865358591079712, Val MSE = 10.520642280578613
  1/149 [..............................] - ETA: 1s 35/149 [======>.......................] - ETA: 0s 78/149 [==============>...............] - ETA: 0s106/149 [====================>.........] - ETA: 0s142/149 [===========================>..] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.012303924357359943
Best model MSE = 1.4071564674377441, Val MSE = 5.934341907501221
  1/156 [..............................] - ETA: 2s 32/156 [=====>........................] - ETA: 0s 60/156 [==========>...................] - ETA: 0s 83/156 [==============>...............] - ETA: 0s108/156 [===================>..........] - ETA: 0s136/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 5ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 28/149 [====>.........................] - ETA: 0s 54/149 [=========>....................] - ETA: 0s 86/149 [================>.............] - ETA: 0s116/149 [======================>.......] - ETA: 0s139/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 8ms/step
MADRC = 0.03150412023473918
Best model MSE = 3.927401065826416, Val MSE = 11.174044609069824
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 83/149 [===============>..............] - ETA: 0s115/149 [======================>.......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 2s 23/156 [===>..........................] - ETA: 0s 43/156 [=======>......................] - ETA: 0s 63/156 [===========>..................] - ETA: 0s 83/156 [==============>...............] - ETA: 0s107/156 [===================>..........] - ETA: 0s128/156 [=======================>......] - ETA: 0s149/156 [===========================>..] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.3670460879802704, Val MSE = 0.5763251781463623
  1/148 [..............................] - ETA: 3s 22/148 [===>..........................] - ETA: 0s 41/148 [=======>......................] - ETA: 0s 59/148 [==========>...................] - ETA: 0s 76/148 [==============>...............] - ETA: 0s 95/148 [==================>...........] - ETA: 0s114/148 [======================>.......] - ETA: 0s133/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 52/148 [=========>....................] - ETA: 0s 74/148 [==============>...............] - ETA: 0s103/148 [===================>..........] - ETA: 0s127/148 [========================>.....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.009599192902961177
Best model MSE = 0.37758681178092957, Val MSE = 0.7559231519699097
  1/156 [..............................] - ETA: 2s 23/156 [===>..........................] - ETA: 0s 46/156 [=======>......................] - ETA: 0s 68/156 [============>.................] - ETA: 0s 94/156 [=================>............] - ETA: 0s117/156 [=====================>........] - ETA: 0s141/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 10ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.1954419612884521, Val MSE = 2.9391536712646484
  1/148 [..............................] - ETA: 1s 21/148 [===>..........................] - ETA: 0s 43/148 [=======>......................] - ETA: 0s 58/148 [==========>...................] - ETA: 0s 76/148 [==============>...............] - ETA: 0s 99/148 [===================>..........] - ETA: 0s122/148 [=======================>......] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.025905019913070086
Best model MSE = 2.152144432067871, Val MSE = 4.952141284942627
  1/148 [..............................] - ETA: 3s 23/148 [===>..........................] - ETA: 0s 48/148 [========>.....................] - ETA: 0s 70/148 [=============>................] - ETA: 0s 96/148 [==================>...........] - ETA: 0s121/148 [=======================>......] - ETA: 0s144/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.283716082572937, Val MSE = 3.6975176334381104
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 47/156 [========>.....................] - ETA: 0s 70/156 [============>.................] - ETA: 0s 92/156 [================>.............] - ETA: 0s115/156 [=====================>........] - ETA: 0s138/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.497248888015747, Val MSE = 4.264201641082764
  1/148 [..............................] - ETA: 2s 18/148 [==>...........................] - ETA: 0s 37/148 [======>.......................] - ETA: 0s 55/148 [==========>...................] - ETA: 0s 74/148 [==============>...............] - ETA: 0s 93/148 [=================>............] - ETA: 0s109/148 [=====================>........] - ETA: 0s124/148 [========================>.....] - ETA: 0s139/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 3s 19/148 [==>...........................] - ETA: 0s 34/148 [=====>........................] - ETA: 0s 51/148 [=========>....................] - ETA: 0s 66/148 [============>.................] - ETA: 0s 83/148 [===============>..............] - ETA: 0s 99/148 [===================>..........] - ETA: 0s117/148 [======================>.......] - ETA: 0s132/148 [=========================>....] - ETA: 0s147/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.5912530422210693, Val MSE = 2.135226011276245
  1/156 [..............................] - ETA: 3s 14/156 [=>............................] - ETA: 0s 27/156 [====>.........................] - ETA: 0s 41/156 [======>.......................] - ETA: 0s 56/156 [=========>....................] - ETA: 0s 72/156 [============>.................] - ETA: 0s 87/156 [===============>..............] - ETA: 0s100/156 [==================>...........] - ETA: 0s107/156 [===================>..........] - ETA: 0s122/156 [======================>.......] - ETA: 0s137/156 [=========================>....] - ETA: 0s153/156 [============================>.] - ETA: 0s156/156 [==============================] - 1s 4ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 7, 'KEEP_HOLDING_RATE': 0.5, 'TAKE_PROFIT_ACTIVE_ACTION': (2, 1.5), 'BID_RISK_RATE': 0.05}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 35/149 [======>.......................] - ETA: 0s 72/149 [=============>................] - ETA: 0s110/149 [=====================>........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 77/149 [==============>...............] - ETA: 0s116/149 [======================>.......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 2s 44/157 [=======>......................] - ETA: 0s 88/157 [===============>..............] - ETA: 0s133/157 [========================>.....] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.032896286344684965
Best model MSE = 0.17502568662166595, Val MSE = 2.2821733951568604
  1/149 [..............................] - ETA: 2s 38/149 [======>.......................] - ETA: 0s 76/149 [==============>...............] - ETA: 0s111/149 [=====================>........] - ETA: 0s131/149 [=========================>....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.28843390941619873, Val MSE = 3.671518087387085
  1/148 [..............................] - ETA: 2s 19/148 [==>...........................] - ETA: 0s 37/148 [======>.......................] - ETA: 0s 56/148 [==========>...................] - ETA: 0s 73/148 [=============>................] - ETA: 0s 92/148 [=================>............] - ETA: 0s114/148 [======================>.......] - ETA: 0s136/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.017636698452663354
Best model MSE = 0.2802664339542389, Val MSE = 1.771141767501831
  1/157 [..............................] - ETA: 2s 41/157 [======>.......................] - ETA: 0s 82/157 [==============>...............] - ETA: 0s124/157 [======================>.......] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.1125282049179077, Val MSE = 6.9691619873046875
  1/149 [..............................] - ETA: 2s 27/149 [====>.........................] - ETA: 0s 54/149 [=========>....................] - ETA: 0s 82/149 [===============>..............] - ETA: 0s112/149 [=====================>........] - ETA: 0s141/149 [===========================>..] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865370512008667, Val MSE = 10.520697593688965
  1/149 [..............................] - ETA: 2s 41/149 [=======>......................] - ETA: 0s 82/149 [===============>..............] - ETA: 0s122/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 1s 5ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.4071599245071411, Val MSE = 5.934114933013916
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 53/156 [=========>....................] - ETA: 0s 83/156 [==============>...............] - ETA: 0s113/156 [====================>.........] - ETA: 0s143/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 28/149 [====>.........................] - ETA: 0s 54/149 [=========>....................] - ETA: 0s 79/149 [==============>...............] - ETA: 0s 99/149 [==================>...........] - ETA: 0s119/149 [======================>.......] - ETA: 0s141/149 [===========================>..] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03150412023473918
Best model MSE = 3.937513828277588, Val MSE = 11.16380786895752
  1/149 [..............................] - ETA: 2s 39/149 [======>.......................] - ETA: 0s 79/149 [==============>...............] - ETA: 0s119/149 [======================>.......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 2s 27/156 [====>.........................] - ETA: 0s 54/156 [=========>....................] - ETA: 0s 81/156 [==============>...............] - ETA: 0s106/156 [===================>..........] - ETA: 0s132/156 [========================>.....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.366834819316864, Val MSE = 0.5765753388404846
  1/148 [..............................] - ETA: 2s 24/148 [===>..........................] - ETA: 0s 48/148 [========>.....................] - ETA: 0s 70/148 [=============>................] - ETA: 0s 90/148 [=================>............] - ETA: 0s113/148 [=====================>........] - ETA: 0s136/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 28/148 [====>.........................] - ETA: 0s 55/148 [==========>...................] - ETA: 0s 80/148 [===============>..............] - ETA: 0s104/148 [====================>.........] - ETA: 0s130/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.3780059516429901, Val MSE = 0.7554994821548462
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 47/156 [========>.....................] - ETA: 0s 67/156 [===========>..................] - ETA: 0s 89/156 [================>.............] - ETA: 0s110/156 [====================>.........] - ETA: 0s133/156 [========================>.....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.1970082521438599, Val MSE = 2.9380669593811035
  1/148 [..............................] - ETA: 2s 24/148 [===>..........................] - ETA: 0s 44/148 [=======>......................] - ETA: 0s 66/148 [============>.................] - ETA: 0s 88/148 [================>.............] - ETA: 0s107/148 [====================>.........] - ETA: 0s129/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.152122974395752, Val MSE = 4.9521098136901855
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 54/148 [=========>....................] - ETA: 0s 78/148 [==============>...............] - ETA: 0s102/148 [===================>..........] - ETA: 0s127/148 [========================>.....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.283506989479065, Val MSE = 3.698420524597168
  1/156 [..............................] - ETA: 2s 22/156 [===>..........................] - ETA: 0s 44/156 [=======>......................] - ETA: 0s 61/156 [==========>...................] - ETA: 0s 78/156 [==============>...............] - ETA: 0s 96/156 [=================>............] - ETA: 0s118/156 [=====================>........] - ETA: 0s141/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.5018630027770996, Val MSE = 4.263978481292725
  1/148 [..............................] - ETA: 2s 18/148 [==>...........................] - ETA: 0s 35/148 [======>.......................] - ETA: 0s 54/148 [=========>....................] - ETA: 0s 73/148 [=============>................] - ETA: 0s 92/148 [=================>............] - ETA: 0s112/148 [=====================>........] - ETA: 0s131/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1.5, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 27/148 [====>.........................] - ETA: 0s 52/148 [=========>....................] - ETA: 0s 76/148 [==============>...............] - ETA: 0s102/148 [===================>..........] - ETA: 0s129/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.5925979614257812, Val MSE = 2.1347267627716064
  1/156 [..............................] - ETA: 2s 19/156 [==>...........................] - ETA: 0s 38/156 [======>.......................] - ETA: 0s 57/156 [=========>....................] - ETA: 0s 75/156 [=============>................] - ETA: 0s 94/156 [=================>............] - ETA: 0s113/156 [====================>.........] - ETA: 0s132/156 [========================>.....] - ETA: 0s151/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 14, 'KEEP_HOLDING_RATE': 0.5, 'TAKE_PROFIT_ACTIVE_ACTION': (2, 1), 'USE_ATR': True}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 997us/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 43/149 [=======>......................] - ETA: 0s 86/149 [================>.............] - ETA: 0s128/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 2s 39/149 [======>.......................] - ETA: 0s 81/149 [===============>..............] - ETA: 0s121/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 2s 43/157 [=======>......................] - ETA: 0s 89/157 [================>.............] - ETA: 0s134/157 [========================>.....] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.032896286344684965
Best model MSE = 0.1752205640077591, Val MSE = 2.2823081016540527
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 80/149 [===============>..............] - ETA: 0s120/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.2884504497051239, Val MSE = 3.6715614795684814
  1/148 [..............................] - ETA: 2s 23/148 [===>..........................] - ETA: 0s 45/148 [========>.....................] - ETA: 0s 66/148 [============>.................] - ETA: 0s 88/148 [================>.............] - ETA: 0s110/148 [=====================>........] - ETA: 0s132/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 999us/step
MADRC = 0.017636698452663354
Best model MSE = 0.2803063988685608, Val MSE = 1.7711923122406006
  1/157 [..............................] - ETA: 2s 40/157 [======>.......................] - ETA: 0s 75/157 [=============>................] - ETA: 0s104/157 [==================>...........] - ETA: 0s136/157 [========================>.....] - ETA: 0s157/157 [==============================] - 0s 2ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.1118314266204834, Val MSE = 6.969064235687256
  1/149 [..............................] - ETA: 2s 31/149 [=====>........................] - ETA: 0s 55/149 [==========>...................] - ETA: 0s 77/149 [==============>...............] - ETA: 0s 98/149 [==================>...........] - ETA: 0s124/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865880727767944, Val MSE = 10.520783424377441
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 81/149 [===============>..............] - ETA: 0s121/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.4071593284606934, Val MSE = 5.934353351593018
  1/156 [..............................] - ETA: 2s 27/156 [====>.........................] - ETA: 0s 55/156 [=========>....................] - ETA: 0s 82/156 [==============>...............] - ETA: 0s109/156 [===================>..........] - ETA: 0s137/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 27/149 [====>.........................] - ETA: 0s 54/149 [=========>....................] - ETA: 0s 81/149 [===============>..............] - ETA: 0s107/149 [====================>.........] - ETA: 0s132/149 [=========================>....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.03150412023473918
Best model MSE = 3.928205728530884, Val MSE = 11.171951293945312
  1/149 [..............................] - ETA: 2s 39/149 [======>.......................] - ETA: 0s 80/149 [===============>..............] - ETA: 0s120/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 2s 28/156 [====>.........................] - ETA: 0s 54/156 [=========>....................] - ETA: 0s 80/156 [==============>...............] - ETA: 0s106/156 [===================>..........] - ETA: 0s132/156 [========================>.....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.3669692277908325, Val MSE = 0.5761722922325134
  1/148 [..............................] - ETA: 2s 24/148 [===>..........................] - ETA: 0s 47/148 [========>.....................] - ETA: 0s 70/148 [=============>................] - ETA: 0s 92/148 [=================>............] - ETA: 0s115/148 [======================>.......] - ETA: 0s138/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 52/148 [=========>....................] - ETA: 0s 78/148 [==============>...............] - ETA: 0s103/148 [===================>..........] - ETA: 0s130/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.37788480520248413, Val MSE = 0.7549208998680115
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 47/156 [========>.....................] - ETA: 0s 71/156 [============>.................] - ETA: 0s 93/156 [================>.............] - ETA: 0s116/156 [=====================>........] - ETA: 0s140/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.1948070526123047, Val MSE = 2.938709259033203
  1/148 [..............................] - ETA: 2s 22/148 [===>..........................] - ETA: 0s 45/148 [========>.....................] - ETA: 0s 68/148 [============>.................] - ETA: 0s 91/148 [=================>............] - ETA: 0s114/148 [======================>.......] - ETA: 0s137/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.1520702838897705, Val MSE = 4.952123165130615
  1/148 [..............................] - ETA: 3s 20/148 [===>..........................] - ETA: 0s 41/148 [=======>......................] - ETA: 0s 59/148 [==========>...................] - ETA: 0s 78/148 [==============>...............] - ETA: 0s 97/148 [==================>...........] - ETA: 0s116/148 [======================>.......] - ETA: 0s135/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.2834663391113281, Val MSE = 3.700747489929199
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 47/156 [========>.....................] - ETA: 0s 70/156 [============>.................] - ETA: 0s 91/156 [================>.............] - ETA: 0s111/156 [====================>.........] - ETA: 0s134/156 [========================>.....] - ETA: 0s155/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.5026559829711914, Val MSE = 4.265744686126709
  1/148 [..............................] - ETA: 2s 20/148 [===>..........................] - ETA: 0s 39/148 [======>.......................] - ETA: 0s 59/148 [==========>...................] - ETA: 0s 78/148 [==============>...............] - ETA: 0s 97/148 [==================>...........] - ETA: 0s116/148 [======================>.......] - ETA: 0s135/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 29/148 [====>.........................] - ETA: 0s 53/148 [=========>....................] - ETA: 0s 75/148 [==============>...............] - ETA: 0s 94/148 [==================>...........] - ETA: 0s115/148 [======================>.......] - ETA: 0s135/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.5899035930633545, Val MSE = 2.134810447692871
  1/156 [..............................] - ETA: 2s 20/156 [==>...........................] - ETA: 0s 39/156 [======>.......................] - ETA: 0s 58/156 [==========>...................] - ETA: 0s 76/156 [=============>................] - ETA: 0s 94/156 [=================>............] - ETA: 0s113/156 [====================>.........] - ETA: 0s132/156 [========================>.....] - ETA: 0s152/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 14, 'KEEP_HOLDING_RATE': 0.5, 'TAKE_PROFIT_ACTIVE_ACTION': (1.5, 2), 'BID_RISK_RATE': 0.075}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 46/149 [========>.....................] - ETA: 0s 93/149 [=================>............] - ETA: 0s138/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 2s 36/149 [======>.......................] - ETA: 0s 75/149 [==============>...............] - ETA: 0s115/149 [======================>.......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 2s 45/157 [=======>......................] - ETA: 0s 91/157 [================>.............] - ETA: 0s136/157 [========================>.....] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.032896286344684965
Best model MSE = 0.1752028465270996, Val MSE = 2.2821719646453857
  1/149 [..............................] - ETA: 2s 42/149 [=======>......................] - ETA: 0s 83/149 [===============>..............] - ETA: 0s123/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.2884419560432434, Val MSE = 3.6714906692504883
  1/148 [..............................] - ETA: 2s 22/148 [===>..........................] - ETA: 0s 44/148 [=======>......................] - ETA: 0s 62/148 [===========>..................] - ETA: 0s 83/148 [===============>..............] - ETA: 0s104/148 [====================>.........] - ETA: 0s125/148 [========================>.....] - ETA: 0s146/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.017636698452663354
Best model MSE = 0.2801125645637512, Val MSE = 1.7711182832717896
  1/157 [..............................] - ETA: 2s 39/157 [======>.......................] - ETA: 0s 74/157 [=============>................] - ETA: 0s112/157 [====================>.........] - ETA: 0s147/157 [===========================>..] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.111838936805725, Val MSE = 6.969063758850098
  1/149 [..............................] - ETA: 2s 30/149 [=====>........................] - ETA: 0s 58/149 [==========>...................] - ETA: 0s 84/149 [===============>..............] - ETA: 0s111/149 [=====================>........] - ETA: 0s139/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03523343028505901
Best model MSE = 1.7863099575042725, Val MSE = 10.519949913024902
  1/149 [..............................] - ETA: 2s 42/149 [=======>......................] - ETA: 0s 84/149 [===============>..............] - ETA: 0s126/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.407151699066162, Val MSE = 5.934044361114502
  1/156 [..............................] - ETA: 2s 30/156 [====>.........................] - ETA: 0s 59/156 [==========>...................] - ETA: 0s 88/156 [===============>..............] - ETA: 0s118/156 [=====================>........] - ETA: 0s147/156 [===========================>..] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 28/149 [====>.........................] - ETA: 0s 55/149 [==========>...................] - ETA: 0s 82/149 [===============>..............] - ETA: 0s107/149 [====================>.........] - ETA: 0s133/149 [=========================>....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 997us/step
MADRC = 0.03150412023473918
Best model MSE = 3.9255473613739014, Val MSE = 11.172662734985352
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 81/149 [===============>..............] - ETA: 0s121/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 2s 27/156 [====>.........................] - ETA: 0s 54/156 [=========>....................] - ETA: 0s 80/156 [==============>...............] - ETA: 0s106/156 [===================>..........] - ETA: 0s130/156 [========================>.....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.3668007254600525, Val MSE = 0.5762823224067688
  1/148 [..............................] - ETA: 2s 23/148 [===>..........................] - ETA: 0s 46/148 [========>.....................] - ETA: 0s 68/148 [============>.................] - ETA: 0s 91/148 [=================>............] - ETA: 0s114/148 [======================>.......] - ETA: 0s135/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 27/148 [====>.........................] - ETA: 0s 52/148 [=========>....................] - ETA: 0s 78/148 [==============>...............] - ETA: 0s103/148 [===================>..........] - ETA: 0s130/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.377819299697876, Val MSE = 0.7554095387458801
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 47/156 [========>.....................] - ETA: 0s 69/156 [============>.................] - ETA: 0s 90/156 [================>.............] - ETA: 0s112/156 [====================>.........] - ETA: 0s135/156 [========================>.....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.1953446865081787, Val MSE = 2.9393458366394043
  1/148 [..............................] - ETA: 2s 23/148 [===>..........................] - ETA: 0s 44/148 [=======>......................] - ETA: 0s 64/148 [===========>..................] - ETA: 0s 83/148 [===============>..............] - ETA: 0s104/148 [====================>.........] - ETA: 0s125/148 [========================>.....] - ETA: 0s145/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.1522433757781982, Val MSE = 4.952105522155762
  1/148 [..............................] - ETA: 2s 19/148 [==>...........................] - ETA: 0s 38/148 [======>.......................] - ETA: 0s 56/148 [==========>...................] - ETA: 0s 74/148 [==============>...............] - ETA: 0s 93/148 [=================>............] - ETA: 0s113/148 [=====================>........] - ETA: 0s132/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.283188819885254, Val MSE = 3.6990556716918945
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 48/156 [========>.....................] - ETA: 0s 70/156 [============>.................] - ETA: 0s 91/156 [================>.............] - ETA: 0s112/156 [====================>.........] - ETA: 0s134/156 [========================>.....] - ETA: 0s156/156 [==============================] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.5005595684051514, Val MSE = 4.264336109161377
  1/148 [..............................] - ETA: 2s 14/148 [=>............................] - ETA: 0s 29/148 [====>.........................] - ETA: 0s 43/148 [=======>......................] - ETA: 0s 58/148 [==========>...................] - ETA: 0s 75/148 [==============>...............] - ETA: 0s 92/148 [=================>............] - ETA: 0s109/148 [=====================>........] - ETA: 0s125/148 [========================>.....] - ETA: 0s140/148 [===========================>..] - ETA: 0s148/148 [==============================] - 1s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 20/148 [===>..........................] - ETA: 0s 40/148 [=======>......................] - ETA: 0s 57/148 [==========>...................] - ETA: 0s 77/148 [==============>...............] - ETA: 0s 99/148 [===================>..........] - ETA: 0s124/148 [========================>.....] - ETA: 0s147/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.588524341583252, Val MSE = 2.135061740875244
  1/156 [..............................] - ETA: 3s 18/156 [==>...........................] - ETA: 0s 35/156 [=====>........................] - ETA: 0s 52/156 [=========>....................] - ETA: 0s 69/156 [============>.................] - ETA: 0s 86/156 [===============>..............] - ETA: 0s105/156 [===================>..........] - ETA: 0s122/156 [======================>.......] - ETA: 0s139/156 [=========================>....] - ETA: 0s156/156 [==============================] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 7, 'KEEP_HOLDING_RATE': 0.25, 'TAKE_PROFIT_ACTIVE_ACTION': (1.5, 2), 'BID_RISK_RATE': 0.075}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 35/149 [======>.......................] - ETA: 0s 72/149 [=============>................] - ETA: 0s103/149 [===================>..........] - ETA: 0s129/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 2s 33/149 [=====>........................] - ETA: 0s 65/149 [============>.................] - ETA: 0s 97/149 [==================>...........] - ETA: 0s126/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 998us/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 2s 15/157 [=>............................] - ETA: 0s 43/157 [=======>......................] - ETA: 0s 63/157 [===========>..................] - ETA: 0s 69/157 [============>.................] - ETA: 0s 77/157 [=============>................] - ETA: 0s 91/157 [================>.............] - ETA: 0s113/157 [====================>.........] - ETA: 0s135/157 [========================>.....] - ETA: 0s157/157 [==============================] - 0s 3ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.032896286344684965
Best model MSE = 0.17520175874233246, Val MSE = 2.2821669578552246
  1/149 [..............................] - ETA: 2s 29/149 [====>.........................] - ETA: 0s 52/149 [=========>....................] - ETA: 0s 71/149 [=============>................] - ETA: 0s 88/149 [================>.............] - ETA: 0s108/149 [====================>.........] - ETA: 0s135/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.2884506583213806, Val MSE = 3.671563148498535
  1/148 [..............................] - ETA: 3s 16/148 [==>...........................] - ETA: 0s 31/148 [=====>........................] - ETA: 0s 47/148 [========>.....................] - ETA: 0s 61/148 [===========>..................] - ETA: 0s 77/148 [==============>...............] - ETA: 0s 93/148 [=================>............] - ETA: 0s106/148 [====================>.........] - ETA: 0s119/148 [=======================>......] - ETA: 0s133/148 [=========================>....] - ETA: 0s148/148 [==============================] - ETA: 0s148/148 [==============================] - 1s 4ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.017636698452663354
Best model MSE = 0.28026577830314636, Val MSE = 1.7711498737335205
  1/157 [..............................] - ETA: 2s 37/157 [======>.......................] - ETA: 0s 70/157 [============>.................] - ETA: 0s105/157 [===================>..........] - ETA: 0s140/157 [=========================>....] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.111831784248352, Val MSE = 6.969064235687256
  1/149 [..............................] - ETA: 2s 27/149 [====>.........................] - ETA: 0s 54/149 [=========>....................] - ETA: 0s 80/149 [===============>..............] - ETA: 0s108/149 [====================>.........] - ETA: 0s133/149 [=========================>....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865065336227417, Val MSE = 10.520784378051758
  1/149 [..............................] - ETA: 1s 32/149 [=====>........................] - ETA: 0s 70/149 [=============>................] - ETA: 0s103/149 [===================>..........] - ETA: 0s141/149 [===========================>..] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.407141923904419, Val MSE = 5.935244083404541
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 52/156 [=========>....................] - ETA: 0s 81/156 [==============>...............] - ETA: 0s108/156 [===================>..........] - ETA: 0s131/156 [========================>.....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 1s 20/149 [===>..........................] - ETA: 0s 45/149 [========>.....................] - ETA: 0s 71/149 [=============>................] - ETA: 0s 93/149 [=================>............] - ETA: 0s114/149 [=====================>........] - ETA: 0s140/149 [===========================>..] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 5ms/step
MADRC = 0.03150412023473918
Best model MSE = 3.926510810852051, Val MSE = 11.171899795532227
  1/149 [..............................] - ETA: 2s 27/149 [====>.........................] - ETA: 0s 60/149 [===========>..................] - ETA: 0s 89/149 [================>.............] - ETA: 0s118/149 [======================>.......] - ETA: 0s148/149 [============================>.] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 0s/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 3s 24/156 [===>..........................] - ETA: 0s 45/156 [=======>......................] - ETA: 0s 66/156 [===========>..................] - ETA: 0s 88/156 [===============>..............] - ETA: 0s117/156 [=====================>........] - ETA: 0s142/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.366983026266098, Val MSE = 0.5763759016990662
  1/148 [..............................] - ETA: 2s 22/148 [===>..........................] - ETA: 0s 38/148 [======>.......................] - ETA: 0s 43/148 [=======>......................] - ETA: 0s 51/148 [=========>....................] - ETA: 0s 57/148 [==========>...................] - ETA: 0s 67/148 [============>.................] - ETA: 0s 79/148 [===============>..............] - ETA: 0s 86/148 [================>.............] - ETA: 0s103/148 [===================>..........] - ETA: 0s128/148 [========================>.....] - ETA: 0s148/148 [==============================] - 1s 4ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 22/148 [===>..........................] - ETA: 0s 44/148 [=======>......................] - ETA: 0s 68/148 [============>.................] - ETA: 0s 93/148 [=================>............] - ETA: 0s119/148 [=======================>......] - ETA: 0s144/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.3775286078453064, Val MSE = 0.7555097341537476
  1/156 [..............................] - ETA: 2s 23/156 [===>..........................] - ETA: 0s 45/156 [=======>......................] - ETA: 0s 67/156 [===========>..................] - ETA: 0s 88/156 [===============>..............] - ETA: 0s110/156 [====================>.........] - ETA: 0s130/156 [========================>.....] - ETA: 0s149/156 [===========================>..] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.1968374252319336, Val MSE = 2.939222574234009
  1/148 [..............................] - ETA: 2s 22/148 [===>..........................] - ETA: 0s 43/148 [=======>......................] - ETA: 0s 65/148 [============>.................] - ETA: 0s 86/148 [================>.............] - ETA: 0s106/148 [====================>.........] - ETA: 0s124/148 [========================>.....] - ETA: 0s140/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.152085065841675, Val MSE = 4.952115058898926
  1/148 [..............................] - ETA: 2s 25/148 [====>.........................] - ETA: 0s 49/148 [========>.....................] - ETA: 0s 71/148 [=============>................] - ETA: 0s 92/148 [=================>............] - ETA: 0s115/148 [======================>.......] - ETA: 0s137/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.2828351259231567, Val MSE = 3.699665069580078
  1/156 [..............................] - ETA: 2s 22/156 [===>..........................] - ETA: 0s 44/156 [=======>......................] - ETA: 0s 65/156 [===========>..................] - ETA: 0s 86/156 [===============>..............] - ETA: 0s107/156 [===================>..........] - ETA: 0s129/156 [=======================>......] - ETA: 0s150/156 [===========================>..] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.502255439758301, Val MSE = 4.266328811645508
  1/148 [..............................] - ETA: 2s 19/148 [==>...........................] - ETA: 0s 36/148 [======>.......................] - ETA: 0s 54/148 [=========>....................] - ETA: 0s 70/148 [=============>................] - ETA: 0s 88/148 [================>.............] - ETA: 0s106/148 [====================>.........] - ETA: 0s124/148 [========================>.....] - ETA: 0s142/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.056249999999999994, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 52/148 [=========>....................] - ETA: 0s 78/148 [==============>...............] - ETA: 0s102/148 [===================>..........] - ETA: 0s127/148 [========================>.....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.5884392261505127, Val MSE = 2.135075569152832
  1/156 [..............................] - ETA: 2s 18/156 [==>...........................] - ETA: 0s 36/156 [=====>........................] - ETA: 0s 54/156 [=========>....................] - ETA: 0s 72/156 [============>.................] - ETA: 0s 90/156 [================>.............] - ETA: 0s108/156 [===================>..........] - ETA: 0s127/156 [=======================>......] - ETA: 0s145/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 14, 'KEEP_HOLDING_RATE': 0, 'TAKE_PROFIT_ACTIVE_ACTION': (2, 1), 'BID_RISK_RATE': 0.025}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 37/149 [======>.......................] - ETA: 0s 72/149 [=============>................] - ETA: 0s113/149 [=====================>........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 2s 39/149 [======>.......................] - ETA: 0s 77/149 [==============>...............] - ETA: 0s114/149 [=====================>........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 996us/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 2s 43/157 [=======>......................] - ETA: 0s 85/157 [===============>..............] - ETA: 0s128/157 [=======================>......] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 996us/step
MADRC = 0.032896286344684965
Best model MSE = 0.17521312832832336, Val MSE = 2.282294511795044
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 77/149 [==============>...............] - ETA: 0s114/149 [=====================>........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.2884417176246643, Val MSE = 3.671488046646118
  1/148 [..............................] - ETA: 2s 21/148 [===>..........................] - ETA: 0s 42/148 [=======>......................] - ETA: 0s 62/148 [===========>..................] - ETA: 0s 82/148 [===============>..............] - ETA: 0s103/148 [===================>..........] - ETA: 0s124/148 [========================>.....] - ETA: 0s145/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.017636698452663354
Best model MSE = 0.2802655100822449, Val MSE = 1.7711527347564697
  1/157 [..............................] - ETA: 2s 39/157 [======>.......................] - ETA: 0s 78/157 [=============>................] - ETA: 0s118/157 [=====================>........] - ETA: 0s155/157 [============================>.] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.111831545829773, Val MSE = 6.969064235687256
  1/149 [..............................] - ETA: 2s 29/149 [====>.........................] - ETA: 0s 57/149 [==========>...................] - ETA: 0s 86/149 [================>.............] - ETA: 0s111/149 [=====================>........] - ETA: 0s139/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 998us/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865381240844727, Val MSE = 10.520700454711914
  1/149 [..............................] - ETA: 2s 38/149 [======>.......................] - ETA: 0s 77/149 [==============>...............] - ETA: 0s113/149 [=====================>........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.4072097539901733, Val MSE = 5.934373378753662
  1/156 [..............................] - ETA: 10s  6/156 [>.............................] - ETA: 1s  14/156 [=>............................] - ETA: 1s 25/156 [===>..........................] - ETA: 0s 35/156 [=====>........................] - ETA: 0s 46/156 [=======>......................] - ETA: 0s 56/156 [=========>....................] - ETA: 0s 67/156 [===========>..................] - ETA: 0s 78/156 [==============>...............] - ETA: 0s 94/156 [=================>............] - ETA: 0s113/156 [====================>.........] - ETA: 0s133/156 [========================>.....] - ETA: 0s154/156 [============================>.] - ETA: 0s156/156 [==============================] - 1s 4ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 25/149 [====>.........................] - ETA: 0s 51/149 [=========>....................] - ETA: 0s 76/149 [==============>...............] - ETA: 0s 99/149 [==================>...........] - ETA: 0s110/149 [=====================>........] - ETA: 0s127/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03150412023473918
Best model MSE = 3.927046060562134, Val MSE = 11.168102264404297
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 78/149 [==============>...............] - ETA: 0s117/149 [======================>.......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 2s 27/156 [====>.........................] - ETA: 0s 52/156 [=========>....................] - ETA: 0s 78/156 [==============>...............] - ETA: 0s103/156 [==================>...........] - ETA: 0s128/156 [=======================>......] - ETA: 0s154/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.36670008301734924, Val MSE = 0.5762084722518921
  1/148 [..............................] - ETA: 2s 22/148 [===>..........................] - ETA: 0s 44/148 [=======>......................] - ETA: 0s 66/148 [============>.................] - ETA: 0s 86/148 [================>.............] - ETA: 0s109/148 [=====================>........] - ETA: 0s132/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 24/148 [===>..........................] - ETA: 0s 50/148 [=========>....................] - ETA: 0s 75/148 [==============>...............] - ETA: 0s101/148 [===================>..........] - ETA: 0s126/148 [========================>.....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.3776513338088989, Val MSE = 0.7554396986961365
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 45/156 [=======>......................] - ETA: 0s 67/156 [===========>..................] - ETA: 0s 88/156 [===============>..............] - ETA: 0s111/156 [====================>.........] - ETA: 0s133/156 [========================>.....] - ETA: 0s155/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.1952542066574097, Val MSE = 2.9386494159698486
  1/148 [..............................] - ETA: 2s 21/148 [===>..........................] - ETA: 0s 43/148 [=======>......................] - ETA: 0s 64/148 [===========>..................] - ETA: 0s 80/148 [===============>..............] - ETA: 0s 96/148 [==================>...........] - ETA: 0s112/148 [=====================>........] - ETA: 0s133/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.1519877910614014, Val MSE = 4.952153205871582
  1/148 [..............................] - ETA: 2s 25/148 [====>.........................] - ETA: 0s 49/148 [========>.....................] - ETA: 0s 75/148 [==============>...............] - ETA: 0s100/148 [===================>..........] - ETA: 0s126/148 [========================>.....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.2834242582321167, Val MSE = 3.698119878768921
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 45/156 [=======>......................] - ETA: 0s 67/156 [===========>..................] - ETA: 0s 88/156 [===============>..............] - ETA: 0s110/156 [====================>.........] - ETA: 0s130/156 [========================>.....] - ETA: 0s152/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.4971468448638916, Val MSE = 4.267343997955322
  1/148 [..............................] - ETA: 2s 20/148 [===>..........................] - ETA: 0s 38/148 [======>.......................] - ETA: 0s 56/148 [==========>...................] - ETA: 0s 74/148 [==============>...............] - ETA: 0s 93/148 [=================>............] - ETA: 0s110/148 [=====================>........] - ETA: 0s129/148 [=========================>....] - ETA: 0s147/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.018750000000000003, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 52/148 [=========>....................] - ETA: 0s 77/148 [==============>...............] - ETA: 0s102/148 [===================>..........] - ETA: 0s128/148 [========================>.....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.590843439102173, Val MSE = 2.1352484226226807
  1/156 [..............................] - ETA: 3s 20/156 [==>...........................] - ETA: 0s 38/156 [======>.......................] - ETA: 0s 56/156 [=========>....................] - ETA: 0s 74/156 [=============>................] - ETA: 0s 92/156 [================>.............] - ETA: 0s111/156 [====================>.........] - ETA: 0s129/156 [=======================>......] - ETA: 0s146/156 [===========================>..] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 14, 'KEEP_HOLDING_RATE': 0.5, 'TAKE_PROFIT_ACTIVE_ACTION': (2, 1), 'BID_RISK_RATE': 0.05}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 84/149 [===============>..............] - ETA: 0s126/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 2s 36/149 [======>.......................] - ETA: 0s 75/149 [==============>...............] - ETA: 0s112/149 [=====================>........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 2s 43/157 [=======>......................] - ETA: 0s 86/157 [===============>..............] - ETA: 0s129/157 [=======================>......] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.032896286344684965
Best model MSE = 0.1751985102891922, Val MSE = 2.2821531295776367
  1/149 [..............................] - ETA: 2s 36/149 [======>.......................] - ETA: 0s 75/149 [==============>...............] - ETA: 0s109/149 [====================>.........] - ETA: 0s140/149 [===========================>..] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.28817129135131836, Val MSE = 3.6714022159576416
  1/148 [..............................] - ETA: 2s 20/148 [===>..........................] - ETA: 0s 41/148 [=======>......................] - ETA: 0s 62/148 [===========>..................] - ETA: 0s 83/148 [===============>..............] - ETA: 0s104/148 [====================>.........] - ETA: 0s124/148 [========================>.....] - ETA: 0s144/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.017636698452663354
Best model MSE = 0.280710369348526, Val MSE = 1.7693510055541992
  1/157 [..............................] - ETA: 2s 41/157 [======>.......................] - ETA: 0s 80/157 [==============>...............] - ETA: 0s119/157 [=====================>........] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.1118313074111938, Val MSE = 6.969063758850098
  1/149 [..............................] - ETA: 2s 30/149 [=====>........................] - ETA: 0s 60/149 [===========>..................] - ETA: 0s 89/149 [================>.............] - ETA: 0s118/149 [======================>.......] - ETA: 0s148/149 [============================>.] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 997us/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865111827850342, Val MSE = 10.520798683166504
  1/149 [..............................] - ETA: 2s 39/149 [======>.......................] - ETA: 0s 80/149 [===============>..............] - ETA: 0s118/149 [======================>.......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.4071298837661743, Val MSE = 5.936160087585449
  1/156 [..............................] - ETA: 2s 29/156 [====>.........................] - ETA: 0s 56/156 [=========>....................] - ETA: 0s 83/156 [==============>...............] - ETA: 0s111/156 [====================>.........] - ETA: 0s138/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 22/149 [===>..........................] - ETA: 0s 49/149 [========>.....................] - ETA: 0s 75/149 [==============>...............] - ETA: 0s100/149 [===================>..........] - ETA: 0s127/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 996us/step
MADRC = 0.03150412023473918
Best model MSE = 3.9247288703918457, Val MSE = 11.175483703613281
  1/149 [..............................] - ETA: 2s 40/149 [=======>......................] - ETA: 0s 79/149 [==============>...............] - ETA: 0s119/149 [======================>.......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 2s 26/156 [====>.........................] - ETA: 0s 52/156 [=========>....................] - ETA: 0s 78/156 [==============>...............] - ETA: 0s104/156 [===================>..........] - ETA: 0s130/156 [========================>.....] - ETA: 0s155/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.3673796057701111, Val MSE = 0.5764159560203552
  1/148 [..............................] - ETA: 2s 23/148 [===>..........................] - ETA: 0s 45/148 [========>.....................] - ETA: 0s 67/148 [============>.................] - ETA: 0s 89/148 [=================>............] - ETA: 0s112/148 [=====================>........] - ETA: 0s134/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 52/148 [=========>....................] - ETA: 0s 78/148 [==============>...............] - ETA: 0s104/148 [====================>.........] - ETA: 0s130/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.3779299557209015, Val MSE = 0.7553149461746216
  1/156 [..............................] - ETA: 2s 22/156 [===>..........................] - ETA: 0s 44/156 [=======>......................] - ETA: 0s 62/156 [==========>...................] - ETA: 0s 84/156 [===============>..............] - ETA: 0s106/156 [===================>..........] - ETA: 0s128/156 [=======================>......] - ETA: 0s150/156 [===========================>..] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.194929599761963, Val MSE = 2.9386749267578125
  1/148 [..............................] - ETA: 2s 22/148 [===>..........................] - ETA: 0s 44/148 [=======>......................] - ETA: 0s 66/148 [============>.................] - ETA: 0s 84/148 [================>.............] - ETA: 0s100/148 [===================>..........] - ETA: 0s121/148 [=======================>......] - ETA: 0s142/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.15217661857605, Val MSE = 4.952108383178711
  1/148 [..............................] - ETA: 2s 28/148 [====>.........................] - ETA: 0s 56/148 [==========>...................] - ETA: 0s 83/148 [===============>..............] - ETA: 0s109/148 [=====================>........] - ETA: 0s132/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.2820541858673096, Val MSE = 3.698396921157837
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 48/156 [========>.....................] - ETA: 0s 72/156 [============>.................] - ETA: 0s 95/156 [=================>............] - ETA: 0s118/156 [=====================>........] - ETA: 0s142/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.502579927444458, Val MSE = 4.265033721923828
  1/148 [..............................] - ETA: 2s 19/148 [==>...........................] - ETA: 0s 37/148 [======>.......................] - ETA: 0s 55/148 [==========>...................] - ETA: 0s 72/148 [=============>................] - ETA: 0s 89/148 [=================>............] - ETA: 0s107/148 [====================>.........] - ETA: 0s125/148 [========================>.....] - ETA: 0s143/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 1, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 28/148 [====>.........................] - ETA: 0s 56/148 [==========>...................] - ETA: 0s 83/148 [===============>..............] - ETA: 0s109/148 [=====================>........] - ETA: 0s137/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.588949680328369, Val MSE = 2.1353111267089844
  1/156 [..............................] - ETA: 2s 20/156 [==>...........................] - ETA: 0s 39/156 [======>.......................] - ETA: 0s 59/156 [==========>...................] - ETA: 0s 78/156 [==============>...............] - ETA: 0s 98/156 [=================>............] - ETA: 0s118/156 [=====================>........] - ETA: 0s138/156 [=========================>....] - ETA: 0s156/156 [==============================] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 7, 'KEEP_HOLDING_RATE': 0.5, 'TAKE_PROFIT_ACTIVE_ACTION': (2, 1.5), 'USE_ATR': True}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 996us/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 46/149 [========>.....................] - ETA: 0s 92/149 [=================>............] - ETA: 0s138/149 [==========================>...] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 2s 41/149 [=======>......................] - ETA: 0s 83/149 [===============>..............] - ETA: 0s124/149 [=======================>......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 996us/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 2s 47/157 [=======>......................] - ETA: 0s 93/157 [================>.............] - ETA: 0s142/157 [==========================>...] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 996us/step
MADRC = 0.032896286344684965
Best model MSE = 0.17574481666088104, Val MSE = 2.2821314334869385
  1/149 [..............................] - ETA: 2s 42/149 [=======>......................] - ETA: 0s 84/149 [===============>..............] - ETA: 0s126/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.2884417772293091, Val MSE = 3.6714885234832764
  1/148 [..............................] - ETA: 2s 23/148 [===>..........................] - ETA: 0s 46/148 [========>.....................] - ETA: 0s 69/148 [============>.................] - ETA: 0s 90/148 [=================>............] - ETA: 0s112/148 [=====================>........] - ETA: 0s134/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.017636698452663354
Best model MSE = 0.28026580810546875, Val MSE = 1.7711479663848877
  1/157 [..............................] - ETA: 2s 31/157 [====>.........................] - ETA: 0s 55/157 [=========>....................] - ETA: 0s 79/157 [==============>...............] - ETA: 0s109/157 [===================>..........] - ETA: 0s149/157 [===========================>..] - ETA: 0s157/157 [==============================] - 0s 2ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.1118361949920654, Val MSE = 6.969065189361572
  1/149 [..............................] - ETA: 2s 30/149 [=====>........................] - ETA: 0s 59/149 [==========>...................] - ETA: 0s 84/149 [===============>..............] - ETA: 0s104/149 [===================>..........] - ETA: 0s123/149 [=======================>......] - ETA: 0s145/149 [============================>.] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865408658981323, Val MSE = 10.520702362060547
  1/149 [..............................] - ETA: 2s 41/149 [=======>......................] - ETA: 0s 82/149 [===============>..............] - ETA: 0s120/149 [=======================>......] - ETA: 0s148/149 [============================>.] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 4ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.4071130752563477, Val MSE = 5.937323570251465
  1/156 [..............................] - ETA: 2s 30/156 [====>.........................] - ETA: 0s 58/156 [==========>...................] - ETA: 0s 87/156 [===============>..............] - ETA: 0s114/156 [====================>.........] - ETA: 0s142/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 26/149 [====>.........................] - ETA: 0s 49/149 [========>.....................] - ETA: 0s 74/149 [=============>................] - ETA: 0s 98/149 [==================>...........] - ETA: 0s123/149 [=======================>......] - ETA: 0s148/149 [============================>.] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03150412023473918
Best model MSE = 3.9284157752990723, Val MSE = 11.16636848449707
  1/149 [..............................] - ETA: 2s 38/149 [======>.......................] - ETA: 0s 77/149 [==============>...............] - ETA: 0s116/149 [======================>.......] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 2s 22/156 [===>..........................] - ETA: 0s 32/156 [=====>........................] - ETA: 0s 51/156 [========>.....................] - ETA: 0s 76/156 [=============>................] - ETA: 0s101/156 [==================>...........] - ETA: 0s126/156 [=======================>......] - ETA: 0s151/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.3670685887336731, Val MSE = 0.5762582421302795
  1/148 [..............................] - ETA: 2s 22/148 [===>..........................] - ETA: 0s 43/148 [=======>......................] - ETA: 0s 64/148 [===========>..................] - ETA: 0s 84/148 [================>.............] - ETA: 0s105/148 [====================>.........] - ETA: 0s126/148 [========================>.....] - ETA: 0s147/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 49/148 [========>.....................] - ETA: 0s 73/148 [=============>................] - ETA: 0s 97/148 [==================>...........] - ETA: 0s122/148 [=======================>......] - ETA: 0s146/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.37792184948921204, Val MSE = 0.7553966641426086
  1/156 [..............................] - ETA: 2s 23/156 [===>..........................] - ETA: 0s 45/156 [=======>......................] - ETA: 0s 67/156 [===========>..................] - ETA: 0s 88/156 [===============>..............] - ETA: 0s109/156 [===================>..........] - ETA: 0s131/156 [========================>.....] - ETA: 0s153/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 5ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.1961045265197754, Val MSE = 2.938483715057373
  1/148 [..............................] - ETA: 2s 17/148 [==>...........................] - ETA: 0s 35/148 [======>.......................] - ETA: 0s 53/148 [=========>....................] - ETA: 0s 70/148 [=============>................] - ETA: 0s 92/148 [=================>............] - ETA: 0s114/148 [======================>.......] - ETA: 0s135/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.15214467048645, Val MSE = 4.952136516571045
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 51/148 [=========>....................] - ETA: 0s 76/148 [==============>...............] - ETA: 0s100/148 [===================>..........] - ETA: 0s124/148 [========================>.....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.2831233739852905, Val MSE = 3.699479341506958
  1/156 [..............................] - ETA: 2s 22/156 [===>..........................] - ETA: 0s 43/156 [=======>......................] - ETA: 0s 65/156 [===========>..................] - ETA: 0s 86/156 [===============>..............] - ETA: 0s107/156 [===================>..........] - ETA: 0s129/156 [=======================>......] - ETA: 0s151/156 [============================>.] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.5010547637939453, Val MSE = 4.265209674835205
  1/148 [..............................] - ETA: 2s 19/148 [==>...........................] - ETA: 0s 37/148 [======>.......................] - ETA: 0s 55/148 [==========>...................] - ETA: 0s 72/148 [=============>................] - ETA: 0s 90/148 [=================>............] - ETA: 0s108/148 [====================>.........] - ETA: 0s125/148 [========================>.....] - ETA: 0s143/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 25/148 [====>.........................] - ETA: 0s 50/148 [=========>....................] - ETA: 0s 76/148 [==============>...............] - ETA: 0s100/148 [===================>..........] - ETA: 0s125/148 [========================>.....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.589691638946533, Val MSE = 2.1350982189178467
  1/156 [..............................] - ETA: 2s 19/156 [==>...........................] - ETA: 0s 37/156 [======>.......................] - ETA: 0s 55/156 [=========>....................] - ETA: 0s 73/156 [=============>................] - ETA: 0s 89/156 [================>.............] - ETA: 0s106/156 [===================>..........] - ETA: 0s124/156 [======================>.......] - ETA: 0s142/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 14, 'KEEP_HOLDING_RATE': 0.25, 'TAKE_PROFIT_ACTIVE_ACTION': (1.5, 2), 'BID_RISK_RATE': 0.05}
TRAINING PHASE
Train for WMT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.02393910653189657
Best model MSE = 1.9061481952667236, Val MSE = 5.694307804107666
  1/149 [..............................] - ETA: 2s 42/149 [=======>......................] - ETA: 0s 84/149 [===============>..............] - ETA: 0s126/149 [========================>.....] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0.0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'WMT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.0001, 'HIDDEN': 20, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.030253167771444874
Best model MSE = 2.984051465988159, Val MSE = 9.054794311523438
  1/149 [..............................] - ETA: 2s 38/149 [======>.......................] - ETA: 0s 75/149 [==============>...............] - ETA: 0s112/149 [=====================>........] - ETA: 0s149/149 [==============================] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.007009213585767962
Best model MSE = 2.0852277278900146, Val MSE = 2.542574882507324
  1/157 [..............................] - ETA: 2s 42/157 [=======>......................] - ETA: 0s 83/157 [==============>...............] - ETA: 0s123/157 [======================>.......] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for AAPL
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.032896286344684965
Best model MSE = 0.17539571225643158, Val MSE = 2.282139301300049
  1/149 [..............................] - ETA: 2s 33/149 [=====>........................] - ETA: 0s 67/149 [============>.................] - ETA: 0s105/149 [====================>.........] - ETA: 0s142/149 [===========================>..] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'AAPL'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.04178068135572022
Best model MSE = 0.2884417772293091, Val MSE = 3.6714892387390137
  1/148 [..............................] - ETA: 2s 21/148 [===>..........................] - ETA: 0s 42/148 [=======>......................] - ETA: 0s 63/148 [===========>..................] - ETA: 0s 83/148 [===============>..............] - ETA: 0s103/148 [===================>..........] - ETA: 0s124/148 [========================>.....] - ETA: 0s145/148 [============================>.] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 996us/step
MADRC = 0.017636698452663354
Best model MSE = 0.28026580810546875, Val MSE = 1.7711504697799683
  1/157 [..............................] - ETA: 2s 38/157 [======>.......................] - ETA: 0s 76/157 [=============>................] - ETA: 0s115/157 [====================>.........] - ETA: 0s152/157 [============================>.] - ETA: 0s157/157 [==============================] - 0s 1ms/step
Train for MSFT
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.029259256099936348
Best model MSE = 1.1118301153182983, Val MSE = 6.969067096710205
  1/149 [..............................] - ETA: 2s 14/149 [=>............................] - ETA: 0s 27/149 [====>.........................] - ETA: 0s 50/149 [=========>....................] - ETA: 0s 77/149 [==============>...............] - ETA: 0s106/149 [====================>.........] - ETA: 0s133/149 [=========================>....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'MSFT'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.01, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03523343028505901
Best model MSE = 1.7865221500396729, Val MSE = 10.52077579498291
  1/149 [..............................] - ETA: 2s 38/149 [======>.......................] - ETA: 0s 75/149 [==============>...............] - ETA: 0s113/149 [=====================>........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.01, 'HIDDEN': 12, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.012303924357359943
Best model MSE = 1.407182216644287, Val MSE = 5.934382915496826
  1/156 [..............................] - ETA: 2s 29/156 [====>.........................] - ETA: 0s 57/156 [=========>....................] - ETA: 0s 84/156 [===============>..............] - ETA: 0s111/156 [====================>.........] - ETA: 0s139/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for JPM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025564313826854274
Best model MSE = 2.469003915786743, Val MSE = 6.932734966278076
  1/149 [..............................] - ETA: 2s 23/149 [===>..........................] - ETA: 0s 45/149 [========>.....................] - ETA: 0s 67/149 [============>.................] - ETA: 0s 88/149 [================>.............] - ETA: 0s109/149 [====================>.........] - ETA: 0s131/149 [=========================>....] - ETA: 0s149/149 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'JPM'}
loading
Model params
{'WINDOW_SIZE': 20, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.03150412023473918
Best model MSE = 3.920682907104492, Val MSE = 11.184328079223633
  1/149 [..............................] - ETA: 2s 39/149 [======>.......................] - ETA: 0s 77/149 [==============>...............] - ETA: 0s114/149 [=====================>........] - ETA: 0s149/149 [==============================] - 0s 1ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.013955417368819832
Best model MSE = 2.6913223266601562, Val MSE = 5.30126428604126
  1/156 [..............................] - ETA: 2s 21/156 [===>..........................] - ETA: 0s 42/156 [=======>......................] - ETA: 0s 66/156 [===========>..................] - ETA: 0s 90/156 [================>.............] - ETA: 0s114/156 [====================>.........] - ETA: 0s136/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for KO
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015115259467555606
Best model MSE = 0.3668333888053894, Val MSE = 0.5762091279029846
  1/148 [..............................] - ETA: 2s 23/148 [===>..........................] - ETA: 0s 45/148 [========>.....................] - ETA: 0s 67/148 [============>.................] - ETA: 0s 87/148 [================>.............] - ETA: 0s107/148 [====================>.........] - ETA: 0s130/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'KO'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.01880421726968884
Best model MSE = 0.5894728899002075, Val MSE = 0.9244049787521362
  1/148 [..............................] - ETA: 2s 26/148 [====>.........................] - ETA: 0s 53/148 [=========>....................] - ETA: 0s 80/148 [===============>..............] - ETA: 0s106/148 [====================>.........] - ETA: 0s131/148 [=========================>....] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.009599192902961177
Best model MSE = 0.3773486912250519, Val MSE = 0.7552096247673035
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 46/156 [=======>......................] - ETA: 0s 69/156 [============>.................] - ETA: 0s 92/156 [================>.............] - ETA: 0s109/156 [===================>..........] - ETA: 0s122/156 [======================>.......] - ETA: 0s145/156 [==========================>...] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for PG
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.020343969088838013
Best model MSE = 1.1965903043746948, Val MSE = 2.93898606300354
  1/148 [..............................] - ETA: 2s 24/148 [===>..........................] - ETA: 0s 45/148 [========>.....................] - ETA: 0s 68/148 [============>.................] - ETA: 0s 91/148 [=================>............] - ETA: 0s115/148 [======================>.......] - ETA: 0s138/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'PG'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.025905019913070086
Best model MSE = 2.1522154808044434, Val MSE = 4.9521284103393555
  1/148 [..............................] - ETA: 2s 28/148 [====>.........................] - ETA: 0s 55/148 [==========>...................] - ETA: 0s 82/148 [===============>..............] - ETA: 0s108/148 [====================>.........] - ETA: 0s135/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 10, 'DROPOUT': 0.01}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
MADRC = 0.01295782815726219
Best model MSE = 1.2828850746154785, Val MSE = 3.6994943618774414
  1/156 [..............................] - ETA: 2s 24/156 [===>..........................] - ETA: 0s 48/156 [========>.....................] - ETA: 0s 70/156 [============>.................] - ETA: 0s 93/156 [================>.............] - ETA: 0s117/156 [=====================>........] - ETA: 0s140/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 2ms/step
Train for XOM
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.025894086452813155
Best model MSE = 2.4973440170288086, Val MSE = 4.262840270996094
  1/148 [..............................] - ETA: 2s 20/148 [===>..........................] - ETA: 0s 40/148 [=======>......................] - ETA: 0s 59/148 [==========>...................] - ETA: 0s 79/148 [===============>..............] - ETA: 0s 99/148 [===================>..........] - ETA: 0s119/148 [=======================>......] - ETA: 0s139/148 [===========================>..] - ETA: 0s148/148 [==============================] - 0s 3ms/step
Earnings = 0
{<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 5, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.037500000000000006, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}
loading
Model params
{'WINDOW_SIZE': 40, 'LEARNING_RATE': 0.0001, 'HIDDEN': 15, 'DROPOUT': 0.0}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.03460695240338487
Best model MSE = 3.9072518348693848, Val MSE = 7.350995063781738
  1/148 [..............................] - ETA: 2s 28/148 [====>.........................] - ETA: 0s 54/148 [=========>....................] - ETA: 0s 82/148 [===============>..............] - ETA: 0s109/148 [=====================>........] - ETA: 0s137/148 [==========================>...] - ETA: 0s148/148 [==============================] - 0s 2ms/step
Earnings = 0
loading
Model params
{'WINDOW_SIZE': 60, 'LEARNING_RATE': 0.001, 'HIDDEN': 17, 'DROPOUT': 0.05}
1/2 [==============>...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
MADRC = 0.015903401340092996
Best model MSE = 2.5885002613067627, Val MSE = 2.135106086730957
  1/156 [..............................] - ETA: 2s 20/156 [==>...........................] - ETA: 0s 39/156 [======>.......................] - ETA: 0s 59/156 [==========>...................] - ETA: 0s 78/156 [==============>...............] - ETA: 0s 98/156 [=================>............] - ETA: 0s117/156 [=====================>........] - ETA: 0s137/156 [=========================>....] - ETA: 0s156/156 [==============================] - 0s 3ms/step
Final train result = 0.0
TRADING PHASE
BEST TRADE MANAGER PARAMS
{'DAYS_TO_KEEP_LIMIT': 7, 'KEEP_HOLDING_RATE': 0, 'TAKE_PROFIT_ACTIVE_ACTION': (2, 1.5), 'USE_ATR': True}
CHOSEN PARAMS
[('WMT', {<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}), ('AAPL', {<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}), ('MSFT', {<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}), ('JPM', {<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}), ('KO', {<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}), ('PG', {<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'}), ('XOM', {<LSTMDiffTradeAlgorithmHyperparam.TEST_PERIOD_SIZE: 1>: 60, <LSTMDiffTradeAlgorithmHyperparam.PREDICTION_PERIOD: 2>: 3, <LSTMDiffTradeAlgorithmHyperparam.TAKE_ACTION_BARRIER: 3>: 0.01, <LSTMDiffTradeAlgorithmHyperparam.ACTIVE_ACTION_MULTIPLIER: 4>: 2, 'DATA_NAME': 'XOM'})]
            EARNED_PROFIT  WINS  LOSES  DRAWS
STOCK_NAME                                   
XOM              0.000000     0      0      0
PG               0.000000     0      0      0
KO             895.089939     1      0      1
JPM           -522.480103     0      1      0
MSFT             0.000000     0      0      0
AAPL             0.000000     0      0      0
WMT           1135.790558     5      5      5
TOTAL         1508.400394     6      6      6
WIN RATE = 0.3333333333333333
LOSE RATE = 0.3333333333333333
RETURN ON START CAPITAL = 0.007542001972198486
MAX DROWDOWN = 935.2595367431641
AVG WIN / AVG LOSE = 1.9622603050997351
Sharpe ratio = 0.0005376048148692424
Calmar ratio = 0.0005362069632055756
MADRC = 0.007009213585767962
WMT Correlation last known close and prediction on train = 0.999153226662259
WMT Autocorrelation last known close and prediction on train = 0.9765215591826535
MADRC = 0.007009213585767962
WMT Correlation last known close and prediction on full = 0.9999461767221391
WMT Autocorrelation last known close and prediction on full = 0.9979639399406603
MADRC = 0.017636698452663354
AAPL Correlation last known close and prediction on train = 0.9999999991877861
AAPL Autocorrelation last known close and prediction on train = 0.995481088769623
MADRC = 0.017636698452663354
AAPL Correlation last known close and prediction on full = 0.9999999998916735
AAPL Autocorrelation last known close and prediction on full = 0.999281516702794
MADRC = 0.012303924357359943
MSFT Correlation last known close and prediction on train = 0.9999999999953492
MSFT Autocorrelation last known close and prediction on train = 0.9954629342068388
MADRC = 0.012303924357359943
MSFT Correlation last known close and prediction on full = 0.9999999999995011
MSFT Autocorrelation last known close and prediction on full = 0.9993565644242509
MADRC = 0.013955417368819832
JPM Correlation last known close and prediction on train = 0.9999779282892879
JPM Autocorrelation last known close and prediction on train = 0.986740452676296
MADRC = 0.013955417368819832
JPM Correlation last known close and prediction on full = 0.9999958499026879
JPM Autocorrelation last known close and prediction on full = 0.9980247044722755
MADRC = 0.009599192902961177
KO Correlation last known close and prediction on train = 0.9999057708314171
KO Autocorrelation last known close and prediction on train = 0.9406582379219508
MADRC = 0.009599192902961177
KO Correlation last known close and prediction on full = 0.9999965680237701
KO Autocorrelation last known close and prediction on full = 0.9976091492956143
MADRC = 0.01295782815726219
PG Correlation last known close and prediction on train = 0.999978887575552
PG Autocorrelation last known close and prediction on train = 0.9723090267368876
MADRC = 0.01295782815726219
PG Correlation last known close and prediction on full = 0.9999986571688743
PG Autocorrelation last known close and prediction on full = 0.9985691348958177
MADRC = 0.015903401340092996
XOM Correlation last known close and prediction on train = 0.9999946311823925
XOM Autocorrelation last known close and prediction on train = 0.9867899835647918
MADRC = 0.015903401340092996
XOM Correlation last known close and prediction on full = 0.9999984313090456
XOM Autocorrelation last known close and prediction on full = 0.9963028048923711
With respect to 2020 corona crisis
            EARNED_PROFIT         WINS        LOSES        DRAWS
STOCK_NAME                                                      
XOM              0.000000     0.000000     0.000000     0.000000
PG               0.000000     0.000000     0.000000     0.000000
KO               0.000000  -894.089939  -895.089939  -894.089939
JPM              0.000000   522.480103   523.480103   522.480103
MSFT             0.000000     0.000000     0.000000     0.000000
AAPL             0.000000     0.000000     0.000000     0.000000
WMT           -797.009109 -1927.799667 -1927.799667 -1927.799667
TOTAL         -797.009109 -2299.409504 -2299.409504 -2299.409504
WIN RATE = 0.3333333333333333
LOSE RATE = 0.3333333333333333
RETURN ON START CAPITAL = -0.003985045547485352
MAX DROWDOWN = 935.2595367431641
AVG WIN / AVG LOSE = 0.7121096553030237
Sharpe ratio = -0.0004986092884332701
Calmar ratio = -0.0005004601008435699
